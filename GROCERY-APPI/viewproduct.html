<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
      body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden; 
    font-family: Arial, sans-serif;
}

.container {
    display: flex;
    justify-content: center;
    align-items: flex-start; 
    height: 100vh; 
    width: 100vw;
    background-color: #4cae4c; 
    box-sizing: border-box;
    background-image: url('https://static.vecteezy.com/system/resources/previews/003/536/556/non_2x/christmas-tree-background-free-vector.jpg');
}

.pokecontainer {
    background-color: #45DFB1;
    max-width: 350px; 
    width: 100%;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start; 
    height: 100vh; 
    position: relative;
    overflow: hidden; 
}

.header {
    width: 100%;
    position: sticky;
    top: 0;
    left: 0;
    background-color:#80ED99; 
    display: flex;
    justify-content: flex-start; 
    align-items: center;
    padding: 10px;
    z-index: 1000;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); 
    box-sizing: border-box;
    border: 1px solid #ffffff;
    border-radius: 10px;
}

.header .arrow {
    font-size: 24px; 
    color: black; 
    margin-right: 15px; 
}

.header select {
    margin-right: 15px;
    padding: 5px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #fff;
}

.header button {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    font-size: 18px;
    color: rgb(0, 0, 0);
    display: flex;
    align-items: center;
}

.header i {
    font-size: 28px;
    margin-right: 5px;
}

.grocey-items {
    display: flex;
    flex-wrap: wrap;
    margin: 25px 5px 0 5px;
    max-width: 350px;
    gap: 10px;
    overflow-y: auto;
    overflow-x: hidden; 
    max-height: calc(100vh - 70px); 
    padding-bottom: 10px; 
}

.pokecards {
    width: 150px;
    height: 150px;
    background-color: rgb(255, 255, 255);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

.pokecards img {
    height: 110px;
    width: 110px;
}

.pokecards .icon {
    position: absolute;
    height: 35px;
    width: 35px;
    right: 5px;
    top: 5px;
}

.pokecards .title {
    font-weight: bold;
    color: rgb(0, 0, 0);
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    margin: 0;
    text-align: center;
}

/* mdia queery for device with a maximum width of 375px */
@media (max-width: 375px) {
    .pokecards {
        width: 140px;
        height: 140px;
    }
    .pokecards img {
        height: 90px;
        width: 90px;
    }
}


::-webkit-scrollbar {
    display: none;
}

    </style>
</head>
<body>
    <div class="container">
        <!-- Form Container -->
        <div class="pokecontainer" id="form-container">
            <div class="header">
              <button onclick="loadContent('daziboard.html')">
              <i class="fa fa-arrow-left arrow"></i> <!-- Arrow on the left --> </button>
                <!-- Dropdown menu -->
                <select id="categorySelect">
                    <option value="">View All</option>
                    <option value="Fruit">Fruit</option>
                    <option value="Vegetables">Vegetable</option>
                </select>

                <!-- Button -->
                <button style = "position:relative; margin-left: 90px; " onclick="loadContent('addproduct.html')">
                    <i class="fa fa-plus"></i> ITEM
                </button>
            </div>

            <div class="grocey-items" id="itemContainer">
                <!-- this is where items gets dynamically inserted from javascript -->
            </div>
        </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
          const categorySelect = document.getElementById('categorySelect');
          const itemContainer = document.getElementById('itemContainer');
  
          // Retrieve items from localStorage
          const storedItems = localStorage.getItem('items');
          const items = storedItems ? JSON.parse(storedItems) : [];
  
          // Retrieve the list from localStorage, or initialize it as an empty array
          let list = JSON.parse(localStorage.getItem('list')) || [];
  
          function getImageSrc(productName) {
                // Find the item with the specified productName
                const item = items.find(i => i.productName.toLowerCase() === productName.toLowerCase());
                
                // just ready made pictures from website according to corresponding productname 
                if (item && item.image) {
                    return item.image; // Return the Base64 image data
                } else if (item.productName.toLowerCase() == 'mango') {
                    return 'https://cdn-icons-png.flaticon.com/512/17555/17555945.png';
                } else if (item.productName.toLowerCase() == 'lemon') {
                    return 'https://cdn-icons-png.flaticon.com/512/17555/17555939.png';
                } else if (item.productName.toLowerCase() == 'cabbage') {
                    return 'https://cdn-icons-png.flaticon.com/512/765/765618.png';
                } else if (item.productName.toLowerCase() == 'berry') {
                    return 'https://cdn-icons-png.flaticon.com/512/17555/17555912.png';
                } else if (item.productName.toLowerCase() == 'tomato') {
                    return 'https://cdn-icons-png.flaticon.com/512/17540/17540192.png';
                } else if (item.productName.toLowerCase() == 'pineapple') {
                    return 'https://cdn-icons-png.flaticon.com/512/17555/17555963.png';
                } else if (item.productName.toLowerCase() == 'papaya') {
                    return 'https://cdn-icons-png.flaticon.com/512/17555/17555951.png';
                } else if (item.productName.toLowerCase() == 'strawberry') {
                    return 'https://cdn-icons-png.flaticon.com/512/17555/17555975.png';
                } else if (item.productName.toLowerCase() == 'watermelon') {
                    return 'https://cdn-icons-png.flaticon.com/512/17555/17555978.png';
                } else if (item.productName.toLowerCase() == 'broccoli') {
                    return 'https://cdn-icons-png.flaticon.com/512/2347/2347045.png';
                } else if (item.productName.toLowerCase() == 'carrot') {
                    return 'https://cdn-icons-png.flaticon.com/512/2916/2916045.png';
                }
                // Default image source if no img is attached when item is added on the form 
                return 'https://media.istockphoto.com/id/1324356458/vector/picture-icon-photo-frame-symbol-landscape-sign-photograph-gallery-logo-web-interface-and.jpg?s=612x612&w=0&k=20&c=ZmXO4mSgNDPzDRX-F8OKCfmMqqHpqMV6jiNi00Ye7rE=';
            }


          // function that renders items
          function renderItems(category) {
    itemContainer.innerHTML = ''; // Clear existing items
    const filteredItems = category ? items.filter(item => item.category === category) : items;
    
    filteredItems.forEach(item => {
        //  default image source coming from uploaded image 
        let imgSrc = getImageSrc(item.productName);
        let categoryicon = 'https://db.pokemongohub.net/_next/image?url=%2Fimages%2Ficons%2Fico_11_grass.webp&w=48&q=75';

        
        // Customize image icon leaf/fruit based on product name

        if (item.category == "Fruit") {
            categoryicon = "https://db.pokemongohub.net/_next/image?url=%2Fimages%2Ficons%2Fico_13_psychic.webp&w=48&q=75";
        } else {
            categoryicon = categoryicon;
        }

        const itemHTML = `
            <button style="background: none; border: none; cursor: pointer;" onclick="add('${item.productName}', ${item.price}, ${item.quantity}, '${item.store}')">
                <div class="pokecards">
                    <img src="${imgSrc}" alt="${item.productName}"> <!-- Set the image source based on product name -->
                    <img src="${categoryicon}" class="icon"> 
                    <p class="title">${item.productName}</p>
                </div>
            </button>
        `;
        itemContainer.innerHTML += itemHTML;
    });
}

  
          // Render items when the page loads
          renderItems();
  
          // Add event listener for category change
          categorySelect.addEventListener('change', (event) => {
              const selectedCategory = event.target.value;
              renderItems(selectedCategory);
          });
  
          // Function to add items to the list and update localStorage
          window.add = function(productName, price, quantity, store) {
    console.log('Attempting to add to cart:', productName, price, quantity, store);

    // Finds the item if it already exists in the list
    const existingItemIndex = list.findIndex(item => item.productName === productName && item.store === store);

    if (existingItemIndex !== -1) {
        // if item exist it increases the quantity instead
        list[existingItemIndex].quantity += quantity;
    } else {
        // if item does not exist it will add the item
        list.push({ productName, price, quantity, store });
    }

    // Save the updated list to my local storage
    localStorage.setItem('list', JSON.stringify(list));

    // test console if items are added/ pra
    console.log('Updated list:', list);
}
      });
  
      // Function to load content 
      function loadContent(page) {
          window.location.href = page;
      }
  </script>
  
</body>
</html>
